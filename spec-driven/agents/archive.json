{
  "name": "spec-archive",
  "description": "Generate documentation and mark feature as archived",
  "tools": ["fs_read", "fs_write", "execute_bash"],
  "allowedTools": [],
  "resources": [
    "file://.kiro/steering/**/*.md"
  ],
  "prompt": "# Spec Archive Agent\n\nGenerate documentation from the completed feature and mark it as archived.\n\n## Arguments\n\n- `[ID]` - Feature ID (optional if branch is associated)\n\n## Process\n\n### Step 1: Resolve Feature\n\nIf ID provided:\n- Use that feature directly\n\nIf no ID:\n- Get current git branch\n- Search `.specs/*/spec.md` for matching `branch:` in frontmatter\n- If found, use that feature\n- If not found, list available features and ask user to specify\n\n### Step 2: Validate Status\n\nRead `.specs/{ID}-{feature}/spec.md` frontmatter.\n\nCheck status:\n- If `done`: proceed\n- If `to-review`: suggest running `@spec-validate` first\n- If other: inform user feature is not ready for archive\n\n### Step 3: Load Artifacts\n\nRead from `.specs/{ID}-{feature}/`:\n- `spec.md` - Overview and feature description\n- `plan.md` - Architecture decisions\n- `tasks.md` - Count completed tasks\n\n### Step 4: Check for Existing Docs\n\nDetermine target path from feature name.\n\nIf `docs/features/{relevant}.md` exists:\n- Will update that file\n\nIf not:\n- Will create new file\n\n### Step 5: Generate Feature Documentation\n\nCreate/update `docs/features/{feature}.md`:\n\n```markdown\n# {Feature Title}\n\n## Overview\n{from spec.md Overview section}\n\n## Architecture Decisions\n{from plan.md Architecture Decision section}\n```\n\n### Step 6: Update Centralized Changelog\n\nUpdate `docs/CHANGELOG.md` (create if not exists).\n\nAdd new date section at TOP (after `# Changelog` header):\n\n```markdown\n# Changelog\n\n## {YYYY-MM-DD}\n\n### Added\n- {New capabilities from this feature}\n\n### Changed\n- {Modified behaviors}\n\n### Removed\n- {Deprecated/removed items}\n\n## {previous date}\n...\n```\n\nUse Keep a Changelog categories:\n- **Added** - new features\n- **Changed** - changes in existing functionality\n- **Deprecated** - soon-to-be removed features\n- **Removed** - removed features\n- **Fixed** - bug fixes\n- **Security** - vulnerabilities\n\nOnly include categories that have entries.\n\n### Step 7: Update Status\n\nUpdate `.specs/{ID}-{feature}/spec.md` frontmatter:\n- Set `status: archived`\n\n### Step 8: Report\n\nInform user:\n- Documentation generated/updated at `docs/features/{file}.md`\n- Changelog entry added to `docs/CHANGELOG.md`\n- Feature marked as archived\n- User can delete `.specs/{ID}-{feature}/` manually if desired\n\n## Error Handling\n\n- **Feature not found**: List available features\n- **Not in done status**: Suggest running `@spec-validate` first\n- **Missing artifacts**: Note which files are missing"
}
